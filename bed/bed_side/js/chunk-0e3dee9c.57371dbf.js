(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e3dee9c"],{2759:function(e,n,t){e.exports=t.p+"img/nurse_head_animation.a4b39ca4.gif"},"2a1f":function(e,n,t){"use strict";var i=t("cc93"),s=t.n(i);s.a},6748:function(e,n,t){"use strict";t.r(n);var i=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{attrs:{id:"con"}},[i("div",{staticClass:"main-div"},[i("div",{staticClass:"nurse-head"},[i("img",{directives:[{name:"show",rawName:"v-show",value:!e.isConnected,expression:"!isConnected"}],staticClass:"nurse-head-img-dialing",attrs:{src:t("2759")}}),i("img",{directives:[{name:"show",rawName:"v-show",value:e.isConnected,expression:"isConnected"}],staticClass:"nurse-head-img",attrs:{src:t("cc1e")}}),e.isConnected?i("img",{staticClass:"nurse-head-statu",attrs:{src:t("eeb8")}}):e._e()]),i("p",{staticClass:"nurse-dialing",style:{color:e.isConnected?"#27d88b":"#333333"}},[e._v(e._s(e.isConnected?e.isCalling?"已接通":"护士已接收":"呼叫护士中..."))]),i("p",{staticClass:"nurse-waiting"},[e._v(e._s(e.timer))]),i("button",{staticClass:"hang-up-btn",style:{visibility:!e.isConnected||e.isCalling?"visible":"hidden"},on:{click:e.hangup}},[e._v("挂断")])])])},s=[],c=(t("99af"),t("fa7d")),a={data:function(){return{isConnected:!1,isCalling:!1,hour:0,min:0,second:0,canClick:!0}},computed:{timer:function(){return this.isConnected&&this.isCalling?"".concat(("0000000000000000"+this.min).substr(-2),":").concat(("0000000000000000"+this.second).substr(-2)):"请耐心等待"}},created:function(){var e=this;this.$route.query.isCalled?(this.$isCalled="1"===this.$route.query.isCalled,this.$callchannelId=this.$route.query.channelId,this.$callerCode=this.$route.query.callerCode,this.called(),window.plus.voice_call(this.$callchannelId)):Object(c["d"])(window.plus.getMac()).then((function(n){e.$channelId=n,console.log("加入通道"+n),Object(c["e"])("/sound/ring.wav",!0).then((function(n){console.log("playVoice",n),e.$voiceHandler=n}),(function(e){Object(c["f"])(e)})),window.plus.voice_call(n)}),(function(e){Object(c["f"])(e)})),window.plus.registSocketListener()},mounted:function(){var e=this;if(this.canClick){this.canClick=!1;var n=setInterval((function(){e.canClick=!0,clearInterval(n)}),2e3)}window.app=this},methods:{onSocketMessage:function(e){var n=JSON.parse(e);switch(console.log(n),n.code){case"CALL":var t={code:"BACK",data:{callerCode:n.data.callerCode,calledCode:window.plus.getMac(),channelId:n.data.channelId,callStatus:7}};console.log("呼叫中...",n.data),window.plus.webSocket_sendMsg(JSON.stringify(t));break;case"CANCEL":this.$voiceHandler&&this.$voiceHandler.stop(),this.$currentCall=null,window.plus.voice_end(),this.$router.go(-1);break;case"CALLBACK":switch(console.log(this.$voiceHandler,Boolean(this.$voiceHandler)),console.log("位于呼叫",n.data.callStatus,"全部数据",n.data),this.$voiceHandler&&this.$voiceHandler.stop(),n.data.callStatus){case"2":this.calling();break;case"3":this.$currentCall=null,window.plus.voice_end(),this.$router.go(-1);break;case"4":this.$currentCall=null,window.plus.voice_end(),this.$router.go(-1),Object(c["f"])("呼叫超时");break;case"5":case"6":case"7":this.$currentCall=null,Object(c["f"])("呼叫繁忙,请稍后再试"),window.plus.voice_end(),this.$router.go(-1);break;case"8":this.$currentCall=null,window.plus.voice_end(),this.$router.go(-1);break;case"9":window.plus.voice_end(),this.$router.go(-1),Object(c["f"])("呼叫卫浴报警中,请稍后再试");break;default:break}break}},voiceError_callback:function(e){Object(c["f"])(e)},voice_callback:function(){var e=this;if(console.log("通道加入成功：",this.$isCalled),this.$isCalled){var n=JSON.stringify({code:"BACK",data:{channelId:this.$callchannelId,callerCode:this.$callerCode,calledCode:window.plus.getMac(),callStatus:"2"}});window.plus.webSocket_sendMsg(n),this.$currentCall={deviceCode:window.plus.getMac(),channelId:this.$callchannelId}}else Object(c["a"])(window.plus.getMac(),this.$channelId).then((function(n){console.log("当前呼叫",n),e.$currentCall=n}))},deviceCancel:function(){var e=this;this.call.post("deviceCancel",{deviceCode:window.plus.getMac(),channelId:this.$channelId}).then((function(n){1===n.data.code&&e.$router.go(-1)})),window.plus.voice_end()},calling:function(){var e=this;this.isConnected=!0;var n=setTimeout((function(){clearTimeout(n),e.isCalling=!0,setInterval((function(){59===e.second?(e.second=0,e.min++):e.second++}),1e3)}),3e3)},called:function(){var e=this;this.isCalling=!0,this.isConnected=!0,setInterval((function(){59===e.second?(e.second=0,e.min++):e.second++}),1e3)},hangup:function(){var e=this;if(this.canClick){if(window.plus.voice_end(),this.$voiceHandler&&this.$voiceHandler.stop(),!this.$currentCall)return void this.$router.go(-1);this.isConnected?this.call.post("deviceExit",this.$currentCall).then((function(n){1===n.data.code&&e.$router.go(-1)})):this.deviceCancel()}}}},l=a,o=(t("2a1f"),t("2877")),d=Object(o["a"])(l,i,s,!1,null,"1ed5f944",null);n["default"]=d.exports},cc1e:function(e,n,t){e.exports=t.p+"img/nurse_head_big.9f7a9500.png"},cc93:function(e,n,t){},eeb8:function(e,n,t){e.exports=t.p+"img/patient_dialing_connected.c5675f2a.gif"}}]);
//# sourceMappingURL=chunk-0e3dee9c.57371dbf.js.map